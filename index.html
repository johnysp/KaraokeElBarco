<!DOCTYPE html>
<html lang="es">
<head>
  <!-- (El head permanece igual que en tu versión anterior) -->
  <style>
    /* Agrega esto al CSS existente */
    .youtube-player {
      transition: all 0.5s ease;
    }
    .fullscreen-mode {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      width: 100vw !important;
      height: 100vh !important;
      z-index: 9999 !important;
      background: #000;
    }
    .hidden-player {
      display: none !important;
    }
  </style>
</head>
<body>
  <!-- (El body permanece igual hasta el script) -->

  <script>
    // ... (funciones anteriores hasta cargarVideo)

    function cargarVideo(canal, videoId, maintainFullscreen = false) {
      const player = canal === 'a' ? playerA : playerB;
      const otherPlayer = canal === 'a' ? playerB : playerA;
      const playerElement = document.getElementById(`player-${canal}`);
      const otherElement = document.getElementById(`player-${canal === 'a' ? 'b' : 'a'}`);

      // 1. Ocultar y resetear el reproductor inactivo
      otherPlayer.stopVideo();
      otherElement.classList.add('hidden-player');
      otherPlayer.setSize('0', '0');

      // 2. Preparar el reproductor activo
      playerElement.classList.remove('hidden-player');
      player.loadVideoById(videoId);

      // 3. Manejar pantalla completa
      if (maintainFullscreen && autoMixEnabled) {
        setTimeout(() => {
          player.playVideo();
          player.setSize(window.innerWidth, window.innerHeight);
          playerElement.classList.add('fullscreen-mode');
          window.scrollTo(0, 0);
        }, 1500);
      } else {
        player.setSize('560', '315');
        playerElement.classList.remove('fullscreen-mode');
      }
    }

    function detectarFin(event) {
      if (autoMixEnabled && event.data === YT.PlayerState.ENDED) {
        const currentPlayer = event.target;
        const nextChannel = currentPlayer === playerA ? 'b' : 'a';
        const wasFullscreen = currentPlayer === playerA ? 
          document.getElementById('player-a').classList.contains('fullscreen-mode') : 
          document.getElementById('player-b').classList.contains('fullscreen-mode');
        
        buscarVideo(nextChannel, wasFullscreen);
      }
    }

    // ... (resto del código igual)
  </script>
</body>
</html>